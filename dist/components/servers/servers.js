define(["app/core/app_events"],function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=71)}({17:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return a});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function u(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,a)}s((r=r.apply(e,t||[])).next())})}function a(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=0<(o=u.trys).length&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}},69:function(t,n){t.exports=e},71:function(e,t,n){"use strict";n.r(t),n.d(t,"SensuServersCtrl",function(){return u});var r=n(17),o=n(69),i=n.n(o),u=function(){function e(e,t,n,r,o){this.backendSrv=n,this.contextSrv=r,this.$location=o,this.isOrgEditor=r.hasRole("Editor")||r.hasRole("Admin"),document.title="Grafana Sensu App",this.servers=[],this.pageReady=!1,this.getSensuServers()}return e.prototype.getSensuServers=function(){return r.b(this,void 0,void 0,function(){var e;return r.d(this,function(t){return[2,(e=this).backendSrv.get("/api/datasources").then(function(t){e.servers=t.filter(function(e){return"grafana-sensucore-datasource"===e.type}),console.log("servers..."+JSON.stringify(e.servers)),e.pageReady=!0})]})})},e.prototype.confirmDelete=function(e){var t=this;this.backendSrv.delete("/api/datasources/"+e).then(function(){t.getSensuServers()})},e.prototype.deleteSensuServer=function(e){var t=this;i.a.emit("confirm-modal",{title:"Delete",text:"Are you sure you want to delete this data source?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){t.confirmDelete(e.id)}})},e.prototype.addSensuServer=function(){return r.b(this,void 0,void 0,function(){var e,t,n;return r.d(this,function(r){switch(r.label){case 0:return e={name:"SensuAppCore-"+this.servers.length,type:"grafana-sensucore-datasource",access:"proxy",isDefault:!1},[4,this.backendSrv.post("/api/datasources",e)];case 1:return t=r.sent(),n=t.datasource.id,this.$location.url("/plugins/grafana-sensu-app/page/sensu-servers"),window.location.href="/datasources/edit/"+n,[2]}})})},e.prototype.serverInfo=function(e){this.$location.path("plugins/grafana-sensu-app/page/sensu-server-info").search({server:e.id})},e.templateUrl="components/servers/partials/servers.html",e}()}})});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiYXBwL2NvcmUvYXBwX2V2ZW50c1wiIiwid2VicGFjazovLy9zcmMvVXNlcnMvYmdhbm4vRG9jdW1lbnRzL3JlcG9zLWdyYWZhbmEtcGx1Z2lucy9ncmFmYW5hLXNlbnN1LWFwcC9zcmMvY29tcG9uZW50cy9zZXJ2ZXJzL3NlcnZlcnMudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJkZWZhdWx0Iiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiMTciLCJlIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIl9fZXh0ZW5kcyIsIl9fYXNzaWduIiwiX19hd2FpdGVyIiwiX19nZW5lcmF0b3IiLCJleHRlbmRTdGF0aWNzIiwiYiIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiQXJyYXkiLCJfXyIsInRoaXMiLCJjb25zdHJ1Y3RvciIsImFzc2lnbiIsImFyZ3VtZW50cyIsImxlbmd0aCIsImFwcGx5IiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJzdGVwIiwibmV4dCIsInJlamVjdGVkIiwidGhyb3ciLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImJvZHkiLCJmIiwieSIsImciLCJfIiwibGFiZWwiLCJzZW50IiwidHJ5cyIsIm9wcyIsInZlcmIiLCJyZXR1cm4iLCJpdGVyYXRvciIsInYiLCJvcCIsIlR5cGVFcnJvciIsInBvcCIsInB1c2giLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX182OV9fIiwiU2Vuc3VTZXJ2ZXJzQ3RybCIsIiRzY29wZSIsIiRpbmplY3RvciIsImJhY2tlbmRTcnYiLCJjb250ZXh0U3J2IiwiJGxvY2F0aW9uIiwiaXNPcmdFZGl0b3IiLCJoYXNSb2xlIiwiZG9jdW1lbnQiLCJ0aXRsZSIsInNlcnZlcnMiLCJwYWdlUmVhZHkiLCJnZXRTZW5zdVNlcnZlcnMiLCJzZWxmIiwiZmlsdGVyIiwidHlwZSIsImNvbnNvbGUiLCJsb2ciLCJKU09OIiwic3RyaW5naWZ5IiwiY29uZmlybURlbGV0ZSIsImlkIiwiX3RoaXMiLCJkZWxldGUiLCJkZWxldGVTZW5zdVNlcnZlciIsInNlcnZlciIsImdyYWZhbmFfYXBwX2NvcmVfYXBwX2V2ZW50c19fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fX2RlZmF1bHQiLCJhIiwiZW1pdCIsInRleHQiLCJ5ZXNUZXh0IiwiaWNvbiIsIm9uQ29uZmlybSIsImFkZFNlbnN1U2VydmVyIiwicGF5bG9hZCIsImFjY2VzcyIsImlzRGVmYXVsdCIsInBvc3QiLCJyZXNwb25zZSIsIl9hIiwiaW5zdGFuY2VJZCIsImRhdGFzb3VyY2UiLCJ1cmwiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJzZXJ2ZXJJbmZvIiwicGF0aCIsInNlYXJjaCIsInRlbXBsYXRlVXJsIl0sIm1hcHBpbmdzIjoiOERBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLEdBQUEsQ0FDQUcsRUFBQUgsRUFDQUksS0FDQUgsUUFB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QUFaLEdBQUEsT0FBQUEsRUFBQXNDLE9BQUEsT0FPbUIsT0FOWCtDLEVBQVUsQ0FDZGhILEtBQVEsZ0JBQWtCdUMsS0FBS2lELFFBQVE3QyxPQUN2Q2tELEtBQVEsK0JBQ1JvQixPQUFVLFFBQ1ZDLGNBRWUsR0FBTTNFLEtBQUswQyxXQUFXa0MsS0FBSyxtQkFBb0JILGtCQUExREksRUFBV0MsRUFBQW5ELE9BQ1hvRCxFQUFhRixFQUFTRyxXQUFXcEIsR0FDdkM1RCxLQUFLNEMsVUFBVXFDLElBQUksaURBQ25CQyxPQUFPQyxTQUFTQyxLQUFPLHFCQUF1QkwsWUFHaER4QyxFQUFBeEQsVUFBQXNHLFdBQUEsU0FBV3JCLEdBQ1RoRSxLQUFLNEMsVUFBVTBDLEtBQUssb0RBQW9EQyxPQUFPLENBQUN2QixPQUFVQSxFQUFPSixNQXhFNUZyQixFQUFBaUQsWUFBYywyQ0EwRXZCakQsRUFqRkEiLCJmaWxlIjoiY29tcG9uZW50cy9zZXJ2ZXJzL3NlcnZlcnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gNzEpO1xuIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIGlmIChlLmluZGV4T2YocFtpXSkgPCAwKVxyXG4gICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0RlbGVnYXRvcihvKSB7XHJcbiAgICB2YXIgaSwgcDtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiwgZnVuY3Rpb24gKGUpIHsgdGhyb3cgZTsgfSksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4sIGYpIHsgaVtuXSA9IG9bbl0gPyBmdW5jdGlvbiAodikgeyByZXR1cm4gKHAgPSAhcCkgPyB7IHZhbHVlOiBfX2F3YWl0KG9bbl0odikpLCBkb25lOiBuID09PSBcInJldHVyblwiIH0gOiBmID8gZih2KSA6IHY7IH0gOiBmOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jVmFsdWVzKG8pIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgbSA9IG9bU3ltYm9sLmFzeW5jSXRlcmF0b3JdLCBpO1xyXG4gICAgcmV0dXJuIG0gPyBtLmNhbGwobykgOiAobyA9IHR5cGVvZiBfX3ZhbHVlcyA9PT0gXCJmdW5jdGlvblwiID8gX192YWx1ZXMobykgOiBvW1N5bWJvbC5pdGVyYXRvcl0oKSwgaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGkpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlbbl0gPSBvW25dICYmIGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7IHYgPSBvW25dKHYpLCBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCB2LmRvbmUsIHYudmFsdWUpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgZCwgdikgeyBQcm9taXNlLnJlc29sdmUodikudGhlbihmdW5jdGlvbih2KSB7IHJlc29sdmUoeyB2YWx1ZTogdiwgZG9uZTogZCB9KTsgfSwgcmVqZWN0KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tYWtlVGVtcGxhdGVPYmplY3QoY29va2VkLCByYXcpIHtcclxuICAgIGlmIChPYmplY3QuZGVmaW5lUHJvcGVydHkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvb2tlZCwgXCJyYXdcIiwgeyB2YWx1ZTogcmF3IH0pOyB9IGVsc2UgeyBjb29rZWQucmF3ID0gcmF3OyB9XHJcbiAgICByZXR1cm4gY29va2VkO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0U3Rhcihtb2QpIHtcclxuICAgIGlmIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpIHJldHVybiBtb2Q7XHJcbiAgICB2YXIgcmVzdWx0ID0ge307XHJcbiAgICBpZiAobW9kICE9IG51bGwpIGZvciAodmFyIGsgaW4gbW9kKSBpZiAoT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgcmVzdWx0W2tdID0gbW9kW2tdO1xyXG4gICAgcmVzdWx0LmRlZmF1bHQgPSBtb2Q7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzY5X187IiwiXG5pbXBvcnQgYXBwRXZlbnRzIGZyb20gXCJncmFmYW5hL2FwcC9jb3JlL2FwcF9ldmVudHNcIjtcblxuZXhwb3J0IGNsYXNzIFNlbnN1U2VydmVyc0N0cmwge1xuICBzZXJ2ZXI6IGFueTtcbiAgcGFnZVJlYWR5OiBib29sZWFuO1xuICBkYXRhc291cmNlczogW2FueV07XG4gIHNlcnZlcnM6IGFueTtcbiAgaXNPcmdFZGl0b3I6IGJvb2xlYW47XG5cbiAgc3RhdGljIHRlbXBsYXRlVXJsID0gXCJjb21wb25lbnRzL3NlcnZlcnMvcGFydGlhbHMvc2VydmVycy5odG1sXCI7XG5cbiAgLyoqIEBuZ0luamVjdCAqL1xuICBjb25zdHJ1Y3Rvcigkc2NvcGUsICRpbmplY3RvciwgcHJpdmF0ZSBiYWNrZW5kU3J2LCBwcml2YXRlIGNvbnRleHRTcnYsIHByaXZhdGUgJGxvY2F0aW9uKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5pc09yZ0VkaXRvciA9IGNvbnRleHRTcnYuaGFzUm9sZShcIkVkaXRvclwiKSB8fCBjb250ZXh0U3J2Lmhhc1JvbGUoXCJBZG1pblwiKTtcbiAgICBkb2N1bWVudC50aXRsZSA9IFwiR3JhZmFuYSBTZW5zdSBBcHBcIjtcbiAgICB0aGlzLnNlcnZlcnMgPSBbXTtcbiAgICB0aGlzLnBhZ2VSZWFkeSA9IGZhbHNlO1xuICAgIHRoaXMuZ2V0U2Vuc3VTZXJ2ZXJzKCk7XG4gIH1cblxuICBhc3luYyBnZXRTZW5zdVNlcnZlcnMoKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIHRoaXMuYmFja2VuZFNydi5nZXQoXCIvYXBpL2RhdGFzb3VyY2VzXCIpXG4gICAgLnRoZW4oKHJlc3VsdDogYW55KSA9PiB7XG4gICAgICBzZWxmLnNlcnZlcnMgPSByZXN1bHQuZmlsdGVyKChvOiB7IHR5cGU6IHt9OyB9KSA9PiB7XG4gICAgICAgIHJldHVybiBvLnR5cGUgPT09IFwiZ3JhZmFuYS1zZW5zdWNvcmUtZGF0YXNvdXJjZVwiO1xuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZyhcInNlcnZlcnMuLi5cIiArIEpTT04uc3RyaW5naWZ5KHNlbGYuc2VydmVycykpO1xuICAgICAgc2VsZi5wYWdlUmVhZHkgPSB0cnVlO1xuICAgIH0pO1xuICB9XG5cbiAgY29uZmlybURlbGV0ZShpZDogYW55KSB7XG4gICAgdGhpcy5iYWNrZW5kU3J2LmRlbGV0ZShcIi9hcGkvZGF0YXNvdXJjZXMvXCIgKyBpZCkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLmdldFNlbnN1U2VydmVycygpO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlU2Vuc3VTZXJ2ZXIoc2VydmVyKSB7XG4gICAgYXBwRXZlbnRzLmVtaXQoXCJjb25maXJtLW1vZGFsXCIsIHtcbiAgICAgIHRpdGxlOiBcIkRlbGV0ZVwiLFxuICAgICAgdGV4dDogXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgZGF0YSBzb3VyY2U/XCIsXG4gICAgICB5ZXNUZXh0OiBcIkRlbGV0ZVwiLFxuICAgICAgaWNvbjogXCJmYS10cmFzaFwiLFxuICAgICAgb25Db25maXJtOiAoKSA9PiB7XG4gICAgICAgIHRoaXMuY29uZmlybURlbGV0ZShzZXJ2ZXIuaWQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLypcbiAgICAxKSBQT1NUIG5ldyBkYXRhc291cmNlXG4gICAgICAgIFBPU1QgdG8gaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9kYXRhc291cmNlc1xuICAgICAgICB7XG4gICAgICAgICAgXCJuYW1lXCI6XCJTZW5zdSBDb3JlLTJcIixcbiAgICAgICAgICBcInR5cGVcIjpcImdyYWZhbmEtc2Vuc3Vjb3JlLWRhdGFzb3VyY2VcIixcbiAgICAgICAgICBcImFjY2Vzc1wiOlwicHJveHlcIixcbiAgICAgICAgICBcImlzRGVmYXVsdFwiOmZhbHNlXG4gICAgICAgIH1cbiAgICAyKSBHZXQgdGhlIGlkIG9mIHRoZSBjcmVhdGVkIGRhdGFzb3VyY2UgKHdpbGwgYmUgaW4gcmVzcG9uc2UpXG4gICAgICAgIHJlc3BvbnNlLmRhdGFzb3VyY2UuaWRcbiAgICAzKSBTZW5kIHVzZXIgdG8gdGhlIGRhdGFzb3VyY2UgY29uZmlnIHBhZ2UgaHR0cDovL2xvY2FsaG9zdDozMDAwL2RhdGFzb3VyY2VzL2VkaXQvN1xuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRzX2VkaXRvcl91cmk7XG4gICAgICAgIHRoaXMuJGxvY2F0aW9uLnVybCgnL2RhdGFzb3VyY2VzL2VkaXQvNycpO1xuXG4gICAqL1xuICBhc3luYyBhZGRTZW5zdVNlcnZlcigpIHtcbiAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgXCJuYW1lXCI6IFwiU2Vuc3VBcHBDb3JlLVwiICsgdGhpcy5zZXJ2ZXJzLmxlbmd0aCxcbiAgICAgIFwidHlwZVwiOiBcImdyYWZhbmEtc2Vuc3Vjb3JlLWRhdGFzb3VyY2VcIixcbiAgICAgIFwiYWNjZXNzXCI6IFwicHJveHlcIixcbiAgICAgIFwiaXNEZWZhdWx0XCI6IGZhbHNlXG4gICAgfTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYmFja2VuZFNydi5wb3N0KFwiL2FwaS9kYXRhc291cmNlc1wiLCBwYXlsb2FkKTtcbiAgICBjb25zdCBpbnN0YW5jZUlkID0gcmVzcG9uc2UuZGF0YXNvdXJjZS5pZDtcbiAgICB0aGlzLiRsb2NhdGlvbi51cmwoJy9wbHVnaW5zL2dyYWZhbmEtc2Vuc3UtYXBwL3BhZ2Uvc2Vuc3Utc2VydmVycycpO1xuICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9kYXRhc291cmNlcy9lZGl0LycgKyBpbnN0YW5jZUlkO1xuICB9XG5cbiAgc2VydmVySW5mbyhzZXJ2ZXIpIHtcbiAgICB0aGlzLiRsb2NhdGlvbi5wYXRoKFwicGx1Z2lucy9ncmFmYW5hLXNlbnN1LWFwcC9wYWdlL3NlbnN1LXNlcnZlci1pbmZvXCIpLnNlYXJjaCh7XCJzZXJ2ZXJcIjogc2VydmVyLmlkfSk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=